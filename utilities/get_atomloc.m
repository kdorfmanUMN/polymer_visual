function loc = get_atomloc(phase)
    % locations in the asymmetric unit cell, from http://som.web.cmu.edu/frames.html
    % takes a phase as an input
    % outputs loc, an n_atom x 3 vector where n_atom is the number of atoms in the unit cell
    % unit cells in this are shifted to match 
    % currently works for bcc, fcc, a15, sigma, c14, c15, and z. 
    % needs to be modified to work wiith additional phases
    phase = lower(phase);
    asymcoords = containers.Map;
    asymcoords('bcc') = [0 0 0];
    asymcoords('fcc') = [0 0 0];
    asymcoords('a15') = [0 0 0; 1/4 0 1/2];
    asymcoords('sigma') = [0.0000 0.0000 0.0000;
                            0.3981 0.3981 0.0000;
                            0.4632 0.1316 0.0000;
                            0.7376 0.0653 0.0000;
                            0.1823 0.1823 0.2524];
    asymcoords('c14') = [1/3 2/3 0.0620;
                        0.0000 0.0000 0.0000;
                        0.8305 0.6610 0.2500];
    asymcoords('c15') = [5/8 5/8 5/8;
                        0.0000 0.0000 0.0000];
    asymcoords('z') = [0 0 1/4; 1/2 1/2 0; 2/3 1/3 1/2];
    
    % if doing from scratch, IE using symmetry operations for each space
    % group, then comment out 25, and uncomment 22-23
    %locGross = symops(phase, asymcoords(phase)); % get all locations, including duplicates, for the given phase
    %loc = unique(double(locGross),'rows'); % remove duplicates
    
    loc = symopsHardCoded(phase);
    
end

function locGross = symopsHardCoded(phase)
    loclist = containers.Map;
    
    loclist('bcc') = [0,0,0; 0.5,0.5,0.5];
    loclist('fcc') = [0,0,0; 0,0.5,0.5; 0.5,0,0.5; 0.5,0.5,0];
    loclist('a15') = [0,0,0;0,0.5,0.25;0,0.5,0.75;0.25,0,0.5;0.5,0.25,0;0.5,0.5,0.5;0.5,0.75,0;0.75,0,0.5];
    loclist('sigma') = [0,0,0;0.0368000000000000,0.368400000000000,0.500000000000000;0.0653000000000000,0.262400000000000,0;0.101900000000000,0.101900000000000,0.500000000000000;0.131600000000000,0.536800000000000,0;0.182300000000000,0.817700000000000,0.252400000000000;0.182300000000000,0.817700000000000,0.747600000000000;0.237600000000000,0.565300000000000,0.500000000000000;0.262400000000000,0.0653000000000000,0;0.317700000000000,0.317700000000000,0.247600000000000;0.317700000000000,0.317700000000000,0.752400000000000;0.368400000000000,0.0368000000000000,0.500000000000000;0.398100000000000,0.601900000000000,0;0.434700000000000,0.762400000000000,0.500000000000000;0.463200000000000,0.868400000000000,0;0.500000000000000,0.500000000000000,0.500000000000000;0.536800000000000,0.131600000000000,0;0.565300000000000,0.237600000000000,0.500000000000000;0.601900000000000,0.398100000000000,0;0.631600000000000,0.963200000000000,0.500000000000000;0.682300000000000,0.682300000000000,0.247600000000000;0.682300000000000,0.682300000000000,0.752400000000000;0.737600000000000,0.934700000000000,0;0.762400000000000,0.434700000000000,0.500000000000000;0.817700000000000,0.182300000000000,0.252400000000000;0.817700000000000,0.182300000000000,0.747600000000000;0.868400000000000,0.463200000000000,0;0.898100000000000,0.898100000000000,0.500000000000000;0.934700000000000,0.737600000000000,0;0.963200000000000,0.631600000000000,0.500000000000000];
    loclist('c14') = [0,0,0;0,0,0.500000000000000;0.169500000000000,0.339000000000000,0.750000000000000;0.169500000000000,0.830500000000000,0.750000000000000;0.333300000000000,0.666600000000000,0.0620000000000000;0.333300000000000,0.666600000000000,0.438000000000000;0.333300000000000,0.666700000000000,0.0620000000000000;0.333300000000000,0.666700000000000,0.438000000000000;0.333400000000000,0.666700000000000,0.0620000000000000;0.333400000000000,0.666700000000000,0.438000000000000;0.339000000000000,0.169500000000000,0.250000000000000;0.661000000000000,0.830500000000000,0.750000000000000;0.666600000000000,0.333300000000000,0.562000000000000;0.666600000000000,0.333300000000000,0.938000000000000;0.666700000000000,0.333300000000000,0.562000000000000;0.666700000000000,0.333300000000000,0.938000000000000;0.666700000000000,0.333400000000000,0.562000000000000;0.666700000000000,0.333400000000000,0.938000000000000;0.830500000000000,0.169500000000000,0.250000000000000;0.830500000000000,0.661000000000000,0.250000000000000];
    loclist('c15') = [0,0,0.500000000000000;0,0.250000000000000,0.750000000000000;0,0.500000000000000,0;0,0.750000000000000,0.250000000000000;0.125000000000000,0.125000000000000,0.125000000000000;0.125000000000000,0.625000000000000,0.625000000000000;0.250000000000000,0,0.750000000000000;0.250000000000000,0.250000000000000,0.500000000000000;0.250000000000000,0.500000000000000,0.250000000000000;0.250000000000000,0.750000000000000,0;0.375000000000000,0.375000000000000,0.875000000000000;0.375000000000000,0.875000000000000,0.375000000000000;0.500000000000000,0,0;0.500000000000000,0.250000000000000,0.250000000000000;0.500000000000000,0.500000000000000,0.500000000000000;0.500000000000000,0.750000000000000,0.750000000000000;0.625000000000000,0.125000000000000,0.625000000000000;0.625000000000000,0.625000000000000,0.125000000000000;0.750000000000000,0,0.250000000000000;0.750000000000000,0.250000000000000,0;0.750000000000000,0.500000000000000,0.750000000000000;0.750000000000000,0.750000000000000,0.500000000000000;0.875000000000000,0.375000000000000,0.375000000000000;0.875000000000000,0.875000000000000,0.875000000000000];
    loclist('z') = [0,0,0.250000000000000;0,0,0.750000000000000;0,0.500000000000000,0;0.333333333333333,0.666666666666667,0.500000000000000;0.500000000000000,0,0;0.500000000000000,0.500000000000000,0;0.666666666666667,0.333333333333333,0.500000000000000];
    loclist('al2o3') = [0.14790,0.14790,0.14790;0.35210,0.35210,0.35210;0.64790,0.64790,0.64790;0.85210,0.85210,0.85210;0.05610,0.75000,0.44390;0.25000,0.55610,0.94390;0.44390,0.05610,0.75000;0.55610,0.94390,0.25000;0.75000,0.44390,0.05610;0.94390,0.25000,0.55610];
    locGross = loclist(phase);
end

function locGross = symops(phase,asymcoords)
    
    syms x y z
    symoplist = containers.Map;
    
    % below is the map symoplist that is a list of symmetry operations for the space group of each of the phases
    % symmetry operations taken from http://img.chem.ucl.ac.uk/sgp/large/sgp.htm
    symoplist('bcc') = [x,            y,            z;
                      x,           -y,           -z;
                     -x,            y,           -z;
                     -x,           -y,            z;
                      z,            x,            y;
                     -z,           -x,            y;
                      z,           -x,           -y;
                     -z,            x,           -y;
                      y,            z,            x;
                     -y,            z,           -x;
                     -y,           -z,            x;
                      y,           -z,           -x;
                      x,           -z,            y;
                      x,            z,           -y;
                     -x,           -z,           -y;
                     -x,            z,            y;
                      z,            y,           -x;
                     -z,            y,            x;
                     -z,           -y,           -x;
                      z,           -y,            x;
                     -y,            x,            z;
                      y,           -x,            z;
                     -y,           -x,           -z;
                      y,            x,           -z;
                     -x,           -y,           -z;
                     -x,            y,            z;
                      x,           -y,            z;
                      x,            y,           -z;
                     -z,           -x,           -y;
                      z,            x,           -y;
                     -z,            x,            y;
                      z,           -x,            y;
                     -y,           -z,           -x;
                      y,           -z,            x;
                      y,            z,           -x;
                     -y,            z,            x;
                     -x,            z,           -y;
                     -x,           -z,            y;
                      x,            z,            y;
                      x,           -z,           -y;
                     -z,           -y,            x;
                      z,           -y,           -x;
                      z,            y,            x;
                     -z,            y,           -x;
                      y,           -x,           -z;
                     -y,            x,           -z;
                      y,            x,            z;
                     -y,           -x,            z]; %I m 3 m (#229)
    symoplist('bcc') = [symoplist('bcc'); [1/2 1/2 1/2]+symoplist('bcc')];
    
    symoplist('fcc') = [x,            y,            z;
                      x,           -y,           -z;
                     -x,            y,           -z;
                     -x,           -y,            z;
                      z,            x,            y;
                     -z,           -x,            y;
                      z,           -x,           -y;
                     -z,            x,           -y;
                      y,            z,            x;
                     -y,            z,           -x;
                     -y,           -z,            x;
                      y,           -z,           -x;
                      x,           -z,            y;
                      x,            z,           -y;
                     -x,           -z,           -y;
                     -x,            z,            y;
                      z,            y,           -x;
                     -z,            y,            x;
                     -z,           -y,           -x;
                      z,           -y,            x;
                     -y,            x,            z;
                      y,           -x,            z;
                     -y,           -x,           -z;
                      y,            x,           -z;
                     -x,           -y,           -z;
                     -x,            y,            z;
                      x,           -y,            z;
                      x,            y,           -z;
                     -z,           -x,           -y;
                      z,            x,           -y;
                     -z,            x,            y;
                      z,           -x,            y;
                     -y,           -z,           -x;
                      y,           -z,            x;
                      y,            z,           -x;
                     -y,            z,            x;
                     -x,            z,           -y;
                     -x,           -z,            y;
                      x,            z,            y;
                      x,           -z,           -y;
                     -z,           -y,            x;
                      z,           -y,           -x;
                      z,            y,            x;
                     -z,            y,           -x;
                      y,           -x,           -z;
                     -y,            x,           -z;
                      y,            x,            z;
                     -y,           -x,            z]; %F m 3 m (#225)
    symoplist('fcc') = [symoplist('fcc'); [1/2 0 1/2] + symoplist('fcc'); [0 1/2 1/2] + symoplist('fcc'); [1/2 1/2 0] + symoplist('fcc')];
    
    symoplist('a15') = [x,            y,            z;
                      x,           -y,           -z;
                     -x,            y,           -z;
                     -x,           -y,            z;
                      z,            x,            y;
                     -z,           -x,            y;
                      z,           -x,           -y;
                     -z,            x,           -y;
                      y,            z,            x;
                     -y,            z,           -x;
                     -y,           -z,            x;
                      y,           -z,           -x;
                    1/2+x,        1/2-z,        1/2+y;
                    1/2+x,        1/2+z,        1/2-y;
                    1/2-x,        1/2-z,        1/2-y;
                    1/2-x,        1/2+z,        1/2+y;
                    1/2+z,        1/2+y,        1/2-x;
                    1/2-z,        1/2+y,        1/2+x;
                    1/2-z,        1/2-y,        1/2-x;
                    1/2+z,        1/2-y,        1/2+x;
                    1/2-y,        1/2+x,        1/2+z;
                    1/2+y,        1/2-x,        1/2+z;
                    1/2-y,        1/2-x,        1/2-z;
                    1/2+y,        1/2+x,        1/2-z;
                     -x,           -y,           -z;
                     -x,            y,            z;
                      x,           -y,            z;
                      x,            y,           -z;
                     -z,           -x,           -y;
                      z,            x,           -y;
                     -z,            x,            y;
                      z,           -x,            y;
                     -y,           -z,           -x;
                      y,           -z,            x;
                      y,            z,           -x;
                     -y,            z,            x;
                    1/2-x,        1/2+z,        1/2-y;
                    1/2-x,        1/2-z,        1/2+y;
                    1/2+x,        1/2+z,        1/2+y;
                    1/2+x,        1/2-z,        1/2-y;
                    1/2-z,        1/2-y,        1/2+x;
                    1/2+z,        1/2-y,        1/2-x;
                    1/2+z,        1/2+y,        1/2+x;
                    1/2-z,        1/2+y,        1/2-x;
                    1/2+y,        1/2-x,        1/2-z;
                    1/2-y,        1/2+x,        1/2-z;
                    1/2+y,        1/2+x,        1/2+z;
                    1/2-y,        1/2-x,        1/2+z]; %P m -3 n (#223)
    
    symoplist('sigma') = [x,            y,            z;
                     -x,           -y,            z;
                    1/2-y,        1/2+x,        1/2+z;
                    1/2+y,        1/2-x,        1/2+z;
                    1/2-x,        1/2+y,        1/2+z;
                    1/2+x,        1/2-y,        1/2+z;
                      y,            x,            z;
                     -y,           -x,            z;
                     -x,           -y,           -z;
                      x,            y,           -z;
                    1/2+y,        1/2-x,        1/2-z;
                    1/2-y,        1/2+x,        1/2-z;
                    1/2+x,        1/2-y,        1/2-z;
                    1/2-x,        1/2+y,        1/2-z;
                     -y,           -x,           -z;
                      y,            x,           -z]; % P 42/m n m (#136)
    symoplist('sigma') = symoplist('sigma') + [1/2 1/2 1/2];
    symoplist('c14') = [x,            y,            z;
                     -y,           x-y,           z;
                    -x+y,          -x,            z;
                     -x,           -y,          1/2+z;
                     x-y,           x,          1/2+z;
                      y,          -x+y,         1/2+z;
                     -y,           -x,            z;
                    -x+y,           y,            z;
                      x,           x-y,           z;
                      y,            x,          1/2+z;
                     x-y,          -y,          1/2+z;
                     -x,          -x+y,         1/2+z;
                     -x,           -y,           -z;
                      y,          -x+y,          -z;
                     x-y,           x,           -z;
                      x,            y,          1/2-z;
                    -x+y,          -x,          1/2-z;
                     -y,           x-y,         1/2-z;
                      y,            x,           -z;
                     x-y,          -y,           -z;
                     -x,          -x+y,          -z;
                     -y,           -x,          1/2-z;
                    -x+y,           y,          1/2-z;
                      x,           x-y,         1/2-z]; %P 63/m m c (#194)
%     symoplist('c15') = [x,            y,            z;
%                       x,           -y,           -z;
%                      -x,            y,           -z;
%                      -x,           -y,            z;
%                       z,            x,            y;
%                      -z,           -x,            y;
%                       z,           -x,           -y;
%                      -z,            x,           -y;
%                       y,            z,            x;
%                      -y,            z,           -x;
%                      -y,           -z,            x;
%                       y,           -z,           -x;
%                     1/4+x,        1/4-z,        1/4+y;
%                     1/4+x,        1/4+z,        1/4-y;
%                     1/4-x,        1/4-z,        1/4-y;
%                     1/4-x,        1/4+z,        1/4+y;
%                     1/4+z,        1/4+y,        1/4-x;
%                     1/4-z,        1/4+y,        1/4+x;
%                     1/4-z,        1/4-y,        1/4-x;
%                     1/4+z,        1/4-y,        1/4+x;
%                     1/4-y,        1/4+x,        1/4+z;
%                     1/4+y,        1/4-x,        1/4+z;
%                     1/4-y,        1/4-x,        1/4-z;
%                     1/4+y,        1/4+x,        1/4-z;
%                     1/4-x,        1/4-y,        1/4-z;
%                     1/4-x,        1/4+y,        1/4+z;
%                     1/4+x,        1/4-y,        1/4+z;
%                     1/4+x,        1/4+y,        1/4-z;
%                     1/4-z,        1/4-x,        1/4-y;
%                     1/4+z,        1/4+x,        1/4-y;
%                     1/4-z,        1/4+x,        1/4+y;
%                     1/4+z,        1/4-x,        1/4+y;
%                     1/4-y,        1/4-z,        1/4-x;
%                     1/4+y,        1/4-z,        1/4+x;
%                     1/4+y,        1/4+z,        1/4-x;
%                     1/4-y,        1/4+z,        1/4+x;
%                      -x,            z,           -y;
%                      -x,           -z,            y;
%                       x,            z,            y;
%                       x,           -z,           -y;
%                      -z,           -y,            x;
%                       z,           -y,           -x;
%                       z,            y,            x;
%                      -z,            y,           -x;
%                       y,           -x,           -z;
%                      -y,            x,           -z;
%                       y,            x,            z;
%                      -y,           -x,            z]; %F d -3 m (#227)
    
     symoplist('c15') =       [x,            y,            z;
                              x,          1/4-y,        1/4-z;
                            1/4-x,          y,          1/4-z;
                            1/4-x,        1/4-y,          z;
                              z,            x,            y;
                            1/4-z,        1/4-x,          y;
                              z,          1/4-x,        1/4-y;
                            1/4-z,          x,          1/4-y;
                              y,            z,            x;
                            1/4-y,          z,          1/4-x;
                            1/4-y,        1/4-z,          x;
                              y,          1/4-z,        1/4-x;
                            1/4+x,         -z,          1/4+y;
                            1/4+x,        1/4+z,         -y;
                             -x,           -z,           -y;
                             -x,          1/4+z,        1/4+y;
                            1/4+z,        1/4+y,         -x;
                             -z,          1/4+y,        1/4+x;
                             -z,           -y,           -x;
                            1/4+z,         -y,          1/4+x;
                             -y,          1/4+x,        1/4+z;
                            1/4+y,         -x,          1/4+z;
                             -y,           -x,           -z;
                            1/4+y,        1/4+x,         -z; 
                             -x,           -y,           -z;
                             -x,          1/4+y,        1/4+z;
                            1/4+x,         -y,          1/4+z;
                            1/4+x,        1/4+y,         -z;
                             -z,           -x,           -y;
                            1/4+z,        1/4+x,         -y;
                             -z,          1/4+x,        1/4+y;
                            1/4+z,         -x,          1/4+y;
                             -y,           -z,           -x;
                            1/4+y,         -z,          1/4+x;
                            1/4+y,        1/4+z,         -x;
                             -y,          1/4+z,        1/4+x;
                            1/4-x,          z,          1/4-y;
                            1/4-x,        1/4-z,          y;
                              x,            z,            y;
                              x,          1/4-z,        1/4-y;
                            1/4-z,        1/4-y,          x;
                              z,          1/4-y,        1/4-x;
                              z,            y,            x;
                            1/4-z,          y,          1/4-x;
                              y,          1/4-x,        1/4-z;
                            1/4-y,          x,          1/4-z;
                              y,            x,            z;
                            1/4-y,        1/4-x,          z];
     symoplist('c15') = [symoplist('c15'); [1/2 0 1/2] + symoplist('c15'); [0 1/2 1/2] + symoplist('c15'); [1/2 1/2 0] + symoplist('c15')];
     symoplist('c15') = symoplist('c15')-[1/2 0 0]; % a modification made upon visual inspection of a rho_rgrid structure.. shift by 1/2 in x direction.
     
     symoplist('z') = [x,            y,            z;
                     -y,           x-y,           z;
                    -x+y,          -x,            z;
                     -x,           -y,            z;
                     x-y,           x,            z;
                      y,          -x+y,           z;
                     -y,           -x,            z;
                    -x+y,           y,            z;
                      x,           x-y,           z;
                      y,            x,            z;
                     x-y,          -y,            z;
                     -x,          -x+y,           z;
                     -x,           -y,           -z;
                      y,          -x+y,          -z;
                     x-y,           x,           -z;
                      x,            y,           -z;
                    -x+y,          -x,           -z;
                     -y,           x-y,          -z;
                      y,            x,           -z;
                     x-y,          -y,           -z;
                     -x,          -x+y,          -z;
                     -y,           -x,           -z;
                    -x+y,           y,           -z;
                      x,           x-y,          -z]; %P 6/mmm (#191)
       %symoplist('z') = symoplist('z')-[1/2 1/2 0]; % a modification made upon visual inspection of a rho_rgrid structure.. shift by 1/2 in x direction.

                  
     % pull out the symmetry ops we care about
     symop = symoplist(phase);
     n_asym = size(asymcoords,1);
     
     % for each location in the asymmetric unit cell, apply symmetry
     % operations to generate a list of equivalent points. keep duplicates.
     for i = 1:n_asym
         x = asymcoords(i,1);
         y = asymcoords(i,2);
         z = asymcoords(i,3);
         if i==1
             locGross = subs(symop);
         else
             locGross = [locGross; subs(symop)];
         end
     end
     % move all points into the unit cell, ie: 0 <= coord <= 1
     for i = 1:size(locGross,1)
        for j = 1:3
            multiple = abs(floor(double(locGross(i,j))/1)); % equal to number of unit cells away that a point is
            if locGross(i,j)<0
                locGross(i,j) = locGross(i,j)+multiple*1;
            elseif locGross(i,j)>=1
                locGross(i,j) = locGross(i,j)-multiple*1;
            end
        end
    end
end
